<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Delight PK - Product Details</title>

<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: #f8f8f8;
}

/* ðŸ”¹ Header */
header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(135deg, #ff6a00, #ff3d00);
  display: flex;
  align-items: center;
  justify-content: center;
  height: 65px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.15);
  border-bottom-left-radius: 35px;
  border-bottom-right-radius: 35px;
  z-index: 10;
}

.back-btn {
  position: absolute;
  left: 18px;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.9);
  border-radius: 50%;
  width: 38px;
  height: 38px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  cursor: pointer;
}

.back-btn img { width: 22px; height: 22px; }

header h4 {
  color: #fff;
  font-size: 21px;
  font-weight: 600;
}

/* ðŸ”¹ Container */
.container {
  margin-top: 70px;
  padding: 15px;
  max-width: 480px;
  margin-left: auto;
  margin-right: auto;
}

/* ðŸ”¹ Image */
.product-image {
  width: 100%;
  border-radius: 14px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

/* ðŸ”¹ Details Box */
.details {
  background: #fff;
  padding: 15px;
  border-radius: 14px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  margin-top: 15px;
}

.details h2 {
  font-size: 18px;
  margin: 0;
  color: #333;
}

.price {
  font-size: 18px;
  font-weight: 600;
  color: #ff3d00;
  margin: 10px 0;
}

/* ðŸ”¹ Info Badges */
.info-box {
  display: inline-block;
  padding: 6px 10px;
  background: #ffeedb;
  border-radius: 8px;
  margin-right: 6px;
  margin-bottom: 6px;
  color: #333;
  font-size: 13px;
  font-weight: 500;
}

/* ðŸ”¹ Description Box */
.desc {
  background: #fff7ef;
  padding: 12px;
  border-radius: 10px;
  margin-top: 12px;
  border-left: 4px solid #ff6a00;
}

.desc h3 {
  font-size: 15px;
  margin-bottom: 8px;
}

.desc p {
  font-size: 14px;
  line-height: 1.6;
  color: #444;
}

.desc ul {
  padding-left: 18px;
  margin: 0;
}

.desc ul li {
  font-size: 14px;
  line-height: 1.6;
  color: #444;
  margin-bottom: 6px;
}
</style>
</head>

<body>

<header>
  <div class="back-btn" onclick="history.back()">
    <img src="Delight icons/Back.png" alt="Back">
  </div>
  <h4>Product Details</h4>
</header>

<div class="container">
  <img id="mainImage" class="product-image" alt="Product Image">
  <div class="details" id="details">
    <h2>Loading...</h2>
  </div>
</div>

<script>
// ðŸ”¹ formatDescription(): Paragraph + Bullets
function formatDescription(desc) {
  if (!desc) return "";

  desc = desc.replace(/\r\n/g, "\n").replace(/\r/g, "\n").trim();

  const clean = s => s
    .replace(/^[\s\-\*\u2022â€¢]+/, "")
    .replace(/^\d+\.\s*/, "")
    .replace(/\s{2,}/g, " ")
    .trim();

  // CASE A: explicit bullets present
  if (desc.includes("â€¢") || desc.includes("\u2022")) {
    const parts = desc.split(/â€¢|\u2022/).map(p => clean(p)).filter(Boolean);
    if (!parts.length) return "";
    if (parts.length > 1 && parts[0].length < 60 && !parts[0].includes(":")) {
      const intro = parts.shift();
      return `<p>${intro}</p><ul>${parts.map(p => `<li>${p}</li>`).join("")}</ul>`;
    }
    return `<ul>${parts.map(p => `<li>${p}</li>`).join("")}</ul>`;
  }

  // CASE B: split by new lines
  const lines = desc.split("\n").map(l => clean(l)).filter(Boolean);
  if (!lines.length) return "";
  if (lines.length === 1) return `<p>${lines[0]}</p>`;

  const first = lines[0];
  const rest = lines.slice(1);
  if (rest.length && first.length < 200 && !first.includes(":")) {
    return `<p>${first}</p><ul>${rest.map(l => `<li>${l}</li>`).join("")}</ul>`;
  }

  return `<ul>${lines.map(l => `<li>${l}</li>`).join("")}</ul>`;
}

// ðŸ”¹ Render product details
window.onload = () => {
  const product = JSON.parse(localStorage.getItem("selectedItem"));

  if (!product) {
    document.getElementById("details").innerHTML = "<p>No product data found!</p>";
    return;
  }

  // Image
  document.getElementById("mainImage").src =
    (product.images && product.images.length > 0)
      ? product.images[0]
      : product.image || "";

  // Render
  document.getElementById("details").innerHTML = `
    <h2>${product.title || "No Title"}</h2>
    <p class="price">Rs ${product.price || "N/A"}</p>

    ${product.color ? `<div class="info-box">Color: ${product.color}</div>` : ""}
    ${product.size ? `<div class="info-box">Size: ${product.size}</div>` : ""}

    <div class="desc">
      <h3>Description</h3>
      ${formatDescription(product.description)}
    </div>
  `;
};
</script>

</body>
</html>